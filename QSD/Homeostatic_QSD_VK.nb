(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     86220,       2344]
NotebookOptionsPosition[     81615,       2254]
NotebookOutlinePosition[     81955,       2269]
CellTagsIndexPosition[     81912,       2266]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Solving for different probability values", "Title",
 CellChangeTimes->{{3.800091602114814*^9, 3.800091608986808*^9}, {
  3.800334589099387*^9, 
  3.8003345903264093`*^9}},ExpressionUUID->"5c87234e-4abf-43c4-9769-\
9b60f163e7ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.800177549328144*^9, 3.800177549329513*^9}, 
   3.8001777866173267`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"0780766b-f4cd-4a1f-8e6f-16e171f6afee"],

Cell[CellGroupData[{

Cell["Solving the Fokker-Planck equation for 2 clonotypes", "Section",
 CellChangeTimes->{{3.82139953009706*^9, 
  3.821399551427417*^9}},ExpressionUUID->"c338ee92-6ddc-4ee4-997d-\
54e45996d114"],

Cell[CellGroupData[{

Cell["Deterministic limit", "Subsection",
 CellChangeTimes->{{3.821399825683639*^9, 
  3.821399828833282*^9}},ExpressionUUID->"6b9237fc-3418-4167-9f05-\
31bd6aeaeda8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phivalue", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probabilities", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.4"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", " ", "=", " ", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi2", " ", "=", " ", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p10", " ", "=", " ", 
   RowBox[{
    RowBox[{"probabilities", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p11", " ", "=", " ", 
   RowBox[{
    RowBox[{"probabilities", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p20", " ", "=", " ", 
   RowBox[{
    RowBox[{"probabilities", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p21", " ", "=", " ", 
   RowBox[{
    RowBox[{"probabilities", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8203044900535393`*^9, 3.820304509955871*^9}, {
   3.8203056812931023`*^9, 3.820305749098401*^9}, {3.820305785505252*^9, 
   3.820305822080326*^9}, {3.820306202437348*^9, 3.820306250312861*^9}, {
   3.820306528278758*^9, 3.820306530283059*^9}, {3.820306582010365*^9, 
   3.820306582308717*^9}, 3.820705221906208*^9, {3.820705257017008*^9, 
   3.820705261384899*^9}, {3.820706588725603*^9, 3.820706592902261*^9}, {
   3.820708179875553*^9, 3.820708207342848*^9}, {3.820708459689732*^9, 
   3.820708488301167*^9}, {3.8207087363440847`*^9, 3.8207087364497957`*^9}, {
   3.820709456261655*^9, 3.820709456430192*^9}, {3.820709833022626*^9, 
   3.8207098454510098`*^9}, {3.821399399528702*^9, 3.8213993996623993`*^9}, {
   3.821399486176779*^9, 3.821399506414886*^9}, {3.8214014115392036`*^9, 
   3.8214014328220882`*^9}, {3.821401624380885*^9, 3.82140165676853*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"710d9037-b234-437f-9f56-e0aad4fe3edf"],

Cell[CellGroupData[{

Cell[BoxData["probabilities"], "Input",
 CellChangeTimes->{{3.8203062095941763`*^9, 3.820306211312374*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"c5165834-27b6-4879-9474-ac91f946354a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.6`", ",", "0.4`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6`", ",", "0.4`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.820306211990365*^9, 3.8203062527117157`*^9}, 
   3.820306537481194*^9, 3.82030661384718*^9, 3.820705225804248*^9, 
   3.820705265647481*^9, 3.820706594899983*^9, {3.8207081816771183`*^9, 
   3.820708213880871*^9}, {3.820708462859503*^9, 3.8207084925962543`*^9}, 
   3.820708738873932*^9, 3.820709460500763*^9, 3.820709850913465*^9, 
   3.8207601774231367`*^9, 3.821399515196608*^9, 3.821401489755946*^9, 
   3.821402344182629*^9, 3.821412480182621*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"22e7809e-a95a-4171-87e1-962f97a8d3f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dn1s", " ", "=", " ", 
  RowBox[{
   RowBox[{"phi1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"probabilities", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "n1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}]}], ")"}]}], "-", 
   RowBox[{"mu", "*", "n1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"dn2s", " ", "=", " ", 
  RowBox[{
   RowBox[{"phi2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"probabilities", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "n2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}]}], ")"}]}], "-", 
   RowBox[{"mu", "*", "n2"}]}]}]}], "Input",
 CellChangeTimes->{{3.820305835710473*^9, 3.820305955521758*^9}, {
  3.820306044004674*^9, 3.820306059994937*^9}, {3.820306110457597*^9, 
  3.820306111763332*^9}, {3.8203062372412786`*^9, 3.8203062380853653`*^9}, {
  3.821402015813912*^9, 3.8214020170063457`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"409a3b1b-e139-4c05-aa64-be40938dc5fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "n1"}], "+", 
  RowBox[{"10", " ", 
   RowBox[{"(", 
    RowBox[{"0.6`", "\[VeryThinSpace]", "+", 
     FractionBox[
      RowBox[{"0.4`", " ", "n1"}], 
      RowBox[{"n1", "+", "n2"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.820306238600897*^9, 3.820306254470995*^9}, 
   3.8203065413052053`*^9, 3.8203066157148523`*^9, 3.8207052297868423`*^9, 
   3.820705269471697*^9, 3.820706598128132*^9, {3.820708183147794*^9, 
   3.820708216986454*^9}, {3.820708465017436*^9, 3.820708495067169*^9}, 
   3.820708740685032*^9, 3.820709463306435*^9, 3.820709855963167*^9, 
   3.82076018028826*^9, 3.821399518905765*^9, 3.821401492677258*^9, 
   3.8214019487798653`*^9, 3.8214023519757633`*^9, 3.821412481809997*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"3b75fb54-97f5-4396-a84e-1d9933b82636"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "n2"}], "+", 
  RowBox[{"10", " ", 
   RowBox[{"(", 
    RowBox[{"0.6`", "\[VeryThinSpace]", "+", 
     FractionBox[
      RowBox[{"0.4`", " ", "n2"}], 
      RowBox[{"n1", "+", "n2"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.820306238600897*^9, 3.820306254470995*^9}, 
   3.8203065413052053`*^9, 3.8203066157148523`*^9, 3.8207052297868423`*^9, 
   3.820705269471697*^9, 3.820706598128132*^9, {3.820708183147794*^9, 
   3.820708216986454*^9}, {3.820708465017436*^9, 3.820708495067169*^9}, 
   3.820708740685032*^9, 3.820709463306435*^9, 3.820709855963167*^9, 
   3.82076018028826*^9, 3.821399518905765*^9, 3.821401492677258*^9, 
   3.8214019487798653`*^9, 3.8214023519757633`*^9, 3.8214124818118763`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"0389e8df-c7ba-4f21-a66e-67b78ec09583"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solutionDet", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dn1s", "\[Equal]", "0"}], ",", 
      RowBox[{"dn2s", "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n1", ",", "n2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8203059787899437`*^9, 3.82030598068853*^9}, {
   3.8203061667200327`*^9, 3.820306183470092*^9}, 3.821401398091473*^9, {
   3.8214014507013493`*^9, 3.8214014600706663`*^9}, {3.8214022875868807`*^9, 
   3.821402288112582*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d1d2e89a-b976-4823-ab02-297f77bf84b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"n1", "\[Rule]", "8.`"}], ",", 
    RowBox[{"n2", "\[Rule]", "8.`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.820306183932917*^9, {3.82030624407191*^9, 3.820306261942412*^9}, 
   3.820306543208829*^9, 3.820306617656228*^9, 3.8207052343875303`*^9, 
   3.820705272302217*^9, 3.8207066007355757`*^9, {3.820708185540223*^9, 
   3.820708219113854*^9}, {3.820708467543976*^9, 3.820708499580401*^9}, 
   3.8207087426952953`*^9, 3.820709466759226*^9, 3.820709858328761*^9, 
   3.820760183056169*^9, 3.821399522457934*^9, 3.82140149437078*^9, 
   3.821402355351244*^9, 3.821412483722332*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"b2ba27a0-495b-48d4-a102-b47edf8ed93a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean of fluctuations", "Subsection",
 CellChangeTimes->{{3.8213998065029182`*^9, 3.821399818494512*^9}, {
  3.8214024730324793`*^9, 
  3.821402476238977*^9}},ExpressionUUID->"f5896fa2-82e0-4bd7-aea7-\
1f39e87314d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dxi1s", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi1", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p11", "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], 
            "^", "2"}]}], "-", 
          RowBox[{
           RowBox[{"(", "p10", ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"solutionDet", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ")"}]}]}], 
         ")"}], ")"}]}], "-", "mu"}], ")"}], "xi1"}], " ", "-", " ", 
   RowBox[{"phi1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p11", "*", 
        RowBox[{"solutionDet", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "^", 
       "2"}]}], ")"}], "*", "xi2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"dxi2s", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi2", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p21", "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], 
            "^", "2"}]}], "-", 
          RowBox[{
           RowBox[{"(", "p20", ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"solutionDet", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}], ")"}]}]}], 
         ")"}], ")"}]}], "-", "mu"}], ")"}], "xi2"}], " ", "-", " ", 
   RowBox[{"phi2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p21", "*", 
        RowBox[{"solutionDet", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "^", 
       "2"}]}], ")"}], "*", "xi1"}]}]}]}], "Input",
 CellChangeTimes->{{3.821399857899486*^9, 3.821399870178177*^9}, {
  3.821399974467744*^9, 3.8214000087552433`*^9}, {3.821400111297179*^9, 
  3.821400131648423*^9}, {3.821401551388302*^9, 3.821401584480929*^9}, {
  3.821401667940246*^9, 3.821401775131912*^9}, {3.82140181198612*^9, 
  3.821401841558447*^9}, {3.82140187269869*^9, 3.82140188898884*^9}, {
  3.821401930154414*^9, 3.8214020425441437`*^9}, {3.82140208013232*^9, 
  3.821402213850284*^9}, {3.821402295495531*^9, 3.821402320131995*^9}, {
  3.821402514930969*^9, 3.821402515964746*^9}, {3.821412499380719*^9, 
  3.8214125035081778`*^9}, {3.8214156321122007`*^9, 
  3.8214156390382223`*^9}},ExpressionUUID->"f0b93147-e145-4472-9521-\
e992f39f6171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.75`"}], " ", "xi1"}], "-", 
   RowBox[{"0.125`", " ", "xi2"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.821402045527801*^9, {3.821402091014979*^9, 3.821402114990238*^9}, 
   3.821402216076173*^9, 3.821402370630567*^9, 3.8214025220397997`*^9, 
   3.8214125161845407`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"950a5072-1252-43b6-b85e-0e7aff53fad5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.125`"}], " ", "xi1"}], "-", 
   RowBox[{"1.75`", " ", "xi2"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.821402045527801*^9, {3.821402091014979*^9, 3.821402114990238*^9}, 
   3.821402216076173*^9, 3.821402370630567*^9, 3.8214025220397997`*^9, 
   3.821412516186035*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"424239ff-a252-4743-87c5-a6fda0b61949"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solutionSSFluc", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dxi1s", "\[Equal]", "0"}], ",", 
      RowBox[{"dxi2s", "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi1", ",", "xi2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.821402231861495*^9, 3.8214022599650383`*^9}, {
  3.821402432994792*^9, 3.8214024412169037`*^9}, {3.821402517631081*^9, 
  3.8214025188103123`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"22f9971c-9320-4858-9dce-9a67a4b8f5b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xi1", "\[Rule]", "0.`"}], ",", 
    RowBox[{"xi2", "\[Rule]", "0.`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8214022608579817`*^9, 3.821402374879628*^9, 
  3.8214024436909447`*^9, 3.8214025244135036`*^9, 3.8214125204569473`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"b8a42692-e8c3-44ee-81ae-93edf09ad58d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance matrix of fluctuations", "Subsection",
 CellChangeTimes->{{3.8214024907399473`*^9, 3.821402500325206*^9}, {
  3.821402875028701*^9, 
  3.821402875219933*^9}},ExpressionUUID->"41cd4b31-c643-4806-abd8-\
ff29ff319909"],

Cell[BoxData[
 RowBox[{"dxi12s", "=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi1", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p11", " ", "*", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"solutionDet", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], 
            "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"solutionDet", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
               RowBox[{"solutionDet", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], 
             "^", "2"}]}]}], "-", 
          RowBox[{
           RowBox[{"(", "p10", ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"solutionDet", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ")"}]}]}], 
         ")"}], ")"}]}], "-", "mu"}], ")"}], "xi12"}], " ", "-", " ", 
   RowBox[{"2", "*", "phi1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p11", "*", 
        RowBox[{"solutionDet", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"solutionDet", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "^", 
       "2"}]}], ")"}], "*", "xi2"}]}]}]], "Input",
 CellChangeTimes->{
  3.8214025059733*^9, {3.82140297965551*^9, 
   3.8214030307204447`*^9}},ExpressionUUID->"93cc1c14-033b-4112-8bfe-\
983b87cb337e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving the Fokker-Planck equation for 3 clonotypes", "Section",
 CellChangeTimes->{{3.821399587383048*^9, 
  3.821399601287779*^9}},ExpressionUUID->"ab37a02a-8d5d-4815-b5bd-\
2bf0364ba1de"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"phivalue", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", "15"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilities", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.3", ",", "0.2", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.3", ",", "0.2", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.3", ",", "0.2", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.3", ",", "0.2", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.35", ",", "0.25", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0.35", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.25", ",", "0.3", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.35", ",", "0.25", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.35", ",", "0.2", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.35", ",", "0.25", ",", "0.2", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.45", ",", "0.15", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.45", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.35", ",", "0.15", ",", "0.3", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.45", ",", "0.15", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0.45", ",", "0.2", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.45", ",", "0.15", ",", "0.2", ",", "0.2"}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.2", ",", "0.4", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.2", ",", " ", "0.4", ",", " ", "0.2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "3"}], ",", " ", 
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"0.4", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.1", ",", "0.5", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", " ", "0.1", ",", " ", "0.4", ",", " ", "0.2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"1", "/", "3"}], ",", " ", 
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"0.4", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"probabilities", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2", ",", "0.05", ",", "0.55", ",", "0.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.35", ",", " ", "0.05", ",", " ", "0.4", ",", " ", "0.2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.7", "/", "3"}], ",", " ", 
         RowBox[{"1.1", "/", "3"}], ",", " ", 
         RowBox[{"0.8", "/", "3"}], ",", " ", 
         RowBox[{"0.4", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", " ", "0.3", ",", " ", "0.4", ",", " ", "0.2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", " ", "0.2", ",", " ", 
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"0.4", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0", ",", "0.6", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", " ", "0", ",", " ", "0.4", ",", " ", "0.2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.4", ",", " ", 
          RowBox[{"0.8", "/", "3"}], ",", " ", 
          RowBox[{"0.4", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.3", ",", " ", "0.3", ",", " ", "0.2"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", " ", "0.15", ",", " ", "0.5", ",", " ", "0.1"}],
          "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", " ", "0.1", ",", " ", 
          RowBox[{"1", "/", "3"}], ",", " ", 
          RowBox[{"0.2", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.4", ",", " ", "0.2", ",", " ", "0.2"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.2", ",", " ", "0.5", ",", " ", "0.1"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.6", "/", "3"}], ",", " ", 
          RowBox[{"0.2", "/", "3"}], ",", " ", 
          RowBox[{"1", "/", "3"}], ",", " ", 
          RowBox[{"0.2", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.2", ",", " ", "0.2", ",", " ", "0.4", ",", " ", "0.2"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", " ", "0.1", ",", " ", "0.5", ",", " ", "0.1"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.4", "/", "3"}], ",", " ", 
          RowBox[{"0.4", "/", "3"}], ",", " ", 
          RowBox[{"1", "/", "3"}], ",", " ", 
          RowBox[{"0.2", "/", "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"probabilities", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8207115045660343`*^9, 3.820711519873144*^9}, {
   3.8207115842493*^9, 3.8207117536538353`*^9}, {3.820711796842537*^9, 
   3.820711898755782*^9}, 3.820711948228157*^9, 3.8207119891802073`*^9, {
   3.820756621977674*^9, 3.820756650902411*^9}, {3.820756758326901*^9, 
   3.820756779707045*^9}, {3.820756811899082*^9, 3.820756883338681*^9}, {
   3.820756927771042*^9, 3.820757015924806*^9}, {3.820758711740325*^9, 
   3.820758712071793*^9}, {3.820758744431046*^9, 3.820758832774456*^9}, {
   3.820759086724043*^9, 3.820759109455158*^9}, {3.820760035126533*^9, 
   3.820760070229926*^9}, {3.820762806478655*^9, 3.820762933718568*^9}, {
   3.82076315770418*^9, 3.8207632005420027`*^9}, {3.82079108828234*^9, 
   3.8207911047568893`*^9}, {3.821401988240498*^9, 3.8214019928063507`*^9}, {
   3.8214313642005177`*^9, 3.82143137678552*^9}, {3.821495647839755*^9, 
   3.821495647946475*^9}, {3.821495733425688*^9, 3.821495760967201*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"eb4d7113-195d-4812-9185-51d78b6ecd92"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.2`"},
          {"0.05`"},
          {"0.55`"},
          {"0.2`"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.35`"},
          {"0.05`"},
          {"0.4`"},
          {"0.2`"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0.2333333333333333`"},
          {"0.3666666666666667`"},
          {"0.26666666666666666`"},
          {"0.13333333333333333`"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8207118825601883`*^9, 3.8207118994534903`*^9}, 
   3.8207119928726597`*^9, {3.82075686442386*^9, 3.820756884482913*^9}, 
   3.820757017413067*^9, 3.820758846961186*^9, 3.8207591119502163`*^9, 
   3.820760070793263*^9, 3.820762942622299*^9, 3.82076317425209*^9, 
   3.820763376474475*^9, 3.820765055010161*^9, 3.82079110538975*^9, 
   3.8214313873613234`*^9, 3.821495767161951*^9},
 CellLabel->
  "Out[5]//MatrixForm=",ExpressionUUID->"36a8d743-7e9b-4ced-b689-\
30a41eeeba58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"resultsBiased", " ", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Steady state\>\"", ",", "\"\<Stability\>\"", ",", 
      "\"\<Uniqueness\>\""}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi2", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi3", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"case", "=", "1"}], ",", 
   RowBox[{"case", "<", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "probabilities", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
   RowBox[{"case", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p111", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p112", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p12", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p212", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p22", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p32", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p211", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], " ", "*", " ", "p111"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p311", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p112"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p312", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi2", "/", "phi3"}], ")"}], "*", " ", "p212"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dn1s", "=", 
     RowBox[{
      RowBox[{"phi1", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p111", "-", "p112", "-", "p12"}], ")"}]}], "+", 
      RowBox[{"n1", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", "p111"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p112"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p12"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn2s", "=", 
     RowBox[{
      RowBox[{"phi2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p211", "-", "p212", "-", "p22"}], ")"}]}], "+", 
      RowBox[{"n2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p211"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p212"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p22"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn3s", "=", 
     RowBox[{
      RowBox[{"phi3", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p311", "-", "p312", "-", "p32"}], ")"}]}], "+", 
      RowBox[{"n3", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p311"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p312"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p32"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dn1s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn2s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn3s", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"n1", ">", "0"}], "&&", 
           RowBox[{"n2", ">", "0"}], "&&", 
           RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", "solution"}],
          ",", " ", "True"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"currentResult", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"solution", " ", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n1", ">", "0"}], "&&", 
              RowBox[{"n2", ">", "0"}], "&&", 
              RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", 
             "solution"}], ",", " ", "True"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dn1s", ",", "dn2s", ",", "dn3s"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eigenv", "=", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"M", "/.", 
          RowBox[{"currentResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"M", "//", "MatrixForm"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Print", "[", 
        RowBox[{"eigenv", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"resultsBiased", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", 
             RowBox[{"currentResult", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}], ",", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"eigenv", ",", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}]}], "]"}], ",", "True"}], "}"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"resultsBiased", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", "solution"}], 
           "//", "N"}], ",", "0", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "\[VeryThinSpace]", "solution", "]"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "p111", ",", "p112", ",", "p12", ",", "p212", ",", "dn1s", ",", "dn2s", 
      ",", "dn3s", ",", "solution"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.820712350267509*^9, 3.820712440992128*^9}, 
   3.8207635710303183`*^9, 3.820763638509797*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"e96436ad-0794-45bf-be94-c35fcc145d99"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,11,1,32089813901577013330,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.820765059080036*^9, 3.820791108315052*^9, 
  3.8214314036434937`*^9, 3.8214314554839077`*^9, 3.821495770214694*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"80904d11-2f1a-4f0e-8edc-1ce35f35f12b"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox["0.5`", 
        RowBox[{"n1", "+", "n2"}]], "+", 
       FractionBox["5.5`", 
        RowBox[{"n1", "+", "n3"}]], "+", 
       FractionBox["2.`", 
        RowBox[{"n1", "+", "n2", "+", "n3"}]], "+", 
       RowBox[{"n1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["0.5`", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n1", "+", "n2"}], ")"}], "2"]]}], "-", 
          FractionBox["5.5`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n3"}], ")"}], "2"]], "-", 
          FractionBox["2.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}]}], 
      
      RowBox[{"n1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["0.5`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n2"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}], 
      RowBox[{"n1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["5.5`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n3"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}]},
     {
      RowBox[{"n2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["0.5`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n2"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox["0.5`", 
        RowBox[{"n1", "+", "n2"}]], "+", 
       FractionBox["4.`", 
        RowBox[{"n2", "+", "n3"}]], "+", 
       FractionBox["2.`", 
        RowBox[{"n1", "+", "n2", "+", "n3"}]], "+", 
       RowBox[{"n2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["0.5`", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n1", "+", "n2"}], ")"}], "2"]]}], "-", 
          FractionBox["4.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n2", "+", "n3"}], ")"}], "2"]], "-", 
          FractionBox["2.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}]}], 
      
      RowBox[{"n2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["4.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n2", "+", "n3"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}]},
     {
      RowBox[{"n3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["5.5`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n3"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}], 
      RowBox[{"n3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["4.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n2", "+", "n3"}], ")"}], "2"]]}], "-", 
         FractionBox["2.`", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox["5.5`", 
        RowBox[{"n1", "+", "n3"}]], "+", 
       FractionBox["4.`", 
        RowBox[{"n2", "+", "n3"}]], "+", 
       FractionBox["2.`", 
        RowBox[{"n1", "+", "n2", "+", "n3"}]], "+", 
       RowBox[{"n3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5.5`", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n1", "+", "n3"}], ")"}], "2"]]}], "-", 
          FractionBox["4.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n2", "+", "n3"}], ")"}], "2"]], "-", 
          FractionBox["2.`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}], "2"]]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.820765059125834*^9, 3.820791109699134*^9, 
  3.821431404709187*^9, 3.821431455489649*^9, 3.821495771290131*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"73ef757b-52c6-4907-bede-714f43ab7a19"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "1.0000000000000009`"}]},
      {
       RowBox[{"-", "0.6705472993149135`"}]},
      {
       RowBox[{"-", "0.49283991887042017`"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.820765059125834*^9, 3.820791109699134*^9, 
  3.821431404709187*^9, 3.821431455489649*^9, 3.82149577129222*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"6087c704-db6f-456c-b5d4-8296575d715e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"resultsBiased", "//", "MatrixForm"}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"faf0b435-a3f8-42ce-ae06-a66b6b1bc240"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Steady state\"\>", "\<\"Stability\"\>", "\<\"Uniqueness\"\>"},
     {
      RowBox[{"{", 
       RowBox[{
       "4.044219042497929`", ",", "5.669130609108898`", ",", 
        "11.286650348393172`"}], "}"}], "True", "True"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.820711568800555*^9, 3.8207120007595787`*^9, 
  3.820756891943595*^9, 3.820757027868052*^9, 3.8207589039862537`*^9, 
  3.820759128483378*^9, 3.82076007791816*^9, 3.820762983227602*^9, 
  3.820763395411429*^9, 3.820765063958514*^9, 3.820791114017344*^9, 
  3.821431410705055*^9, 3.821431460032292*^9, 3.821495776058466*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"944f06cd-e6d7-4af3-a23e-\
9953677ccb99"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old version", "Subtitle",
 CellChangeTimes->{{3.820305703724777*^9, 
  3.820305706890543*^9}},ExpressionUUID->"5a1c2cd8-6bac-49c6-bc98-\
c7030d460dfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phivalue", "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "10", ",", "10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probabilities", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"prob", "=", "0"}], ",", 
    RowBox[{"prob", "<", "1.05"}], ",", 
    RowBox[{"prob", "=", 
     RowBox[{"prob", "+", 
      RowBox[{"(", 
       RowBox[{"5", "/", "100"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"probabilityMatrix", "[", 
       RowBox[{"prob", ",", "3", ",", "4", ",", "phivalue"}], "]"}]}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resultsBiased", " ", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Steady state\>\"", ",", "\"\<Stability\>\"", ",", 
      "\"\<Uniqueness\>\""}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi2", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi3", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"case", "=", "1"}], ",", 
   RowBox[{"case", "<", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "probabilities", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
   RowBox[{"case", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p111", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p112", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p12", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p212", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p22", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p32", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p211", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], " ", "*", " ", "p111"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p311", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p112"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p312", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi2", "/", "phi3"}], ")"}], "*", " ", "p212"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dn1s", "=", 
     RowBox[{
      RowBox[{"phi1", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p111", "-", "p112", "-", "p12"}], ")"}]}], "+", 
      RowBox[{"n1", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", "p111"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p112"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p12"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn2s", "=", 
     RowBox[{
      RowBox[{"phi2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p211", "-", "p212", "-", "p22"}], ")"}]}], "+", 
      RowBox[{"n2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p211"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p212"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p22"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn3s", "=", 
     RowBox[{
      RowBox[{"phi3", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p311", "-", "p312", "-", "p32"}], ")"}]}], "+", 
      RowBox[{"n3", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p311"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p312"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p32"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dn1s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn2s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn3s", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"n1", ">", "0"}], "&&", 
           RowBox[{"n2", ">", "0"}], "&&", 
           RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", "solution"}],
          ",", " ", "True"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"currentResult", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"solution", " ", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n1", ">", "0"}], "&&", 
              RowBox[{"n2", ">", "0"}], "&&", 
              RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", 
             "solution"}], ",", " ", "True"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dn1s", ",", "dn2s", ",", "dn3s"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eigenv", "=", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"M", "/.", 
          RowBox[{"currentResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"resultsBiased", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", 
             RowBox[{"currentResult", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}], ",", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"eigenv", ",", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}]}], "]"}], ",", "True"}], "}"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"resultsBiased", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", "solution"}], 
           "//", "N"}], ",", "0", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "\[VeryThinSpace]", "solution", "]"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "p111", ",", "p112", ",", "p12", ",", "p212", ",", "dn1s", ",", "dn2s", 
      ",", "dn3s", ",", "solution"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.800094315220207*^9, 3.800094378839945*^9}, {
   3.800094424395104*^9, 3.8000944872397127`*^9}, {3.800095157843371*^9, 
   3.8000951804822407`*^9}, {3.8000953006479273`*^9, 3.800095316312809*^9}, {
   3.800095799586578*^9, 3.8000958194104567`*^9}, {3.800095870889629*^9, 
   3.800095874554798*^9}, {3.800095904640439*^9, 3.8000959066700087`*^9}, {
   3.800096041044338*^9, 3.80009611573737*^9}, {3.800096172758849*^9, 
   3.800096178793785*^9}, {3.8000962674932203`*^9, 3.800096267752409*^9}, {
   3.800096852196479*^9, 3.800096892108753*^9}, {3.800107416215361*^9, 
   3.800107419197577*^9}, {3.800107452197607*^9, 3.8001074572627907`*^9}, {
   3.800107510026957*^9, 3.800107691278994*^9}, {3.800107778012258*^9, 
   3.800107793175206*^9}, {3.800107956651263*^9, 3.8001079800615797`*^9}, {
   3.800108088528317*^9, 3.8001080976584673`*^9}, {3.800108143554174*^9, 
   3.8001081443764153`*^9}, 3.800108592723158*^9, {3.80010863768287*^9, 
   3.800108645829883*^9}, {3.8001086884315863`*^9, 3.80010869000668*^9}, {
   3.80010878653905*^9, 3.8001088135508223`*^9}, {3.800109060572111*^9, 
   3.800109062249402*^9}, {3.800109280365038*^9, 3.800109280534698*^9}, {
   3.8001093719703913`*^9, 3.8001093838035803`*^9}, {3.800109589570408*^9, 
   3.800109631956069*^9}, {3.80010979604401*^9, 3.800109810780593*^9}, {
   3.800109872995657*^9, 3.8001098912826643`*^9}, {3.8001099389742928`*^9, 
   3.800109986831815*^9}, {3.800110099340708*^9, 3.800110131008327*^9}, 
   3.800110161848919*^9, {3.800110520578826*^9, 3.800110521243232*^9}, {
   3.8001107699560328`*^9, 3.8001107994247913`*^9}, 3.8001108639682713`*^9, {
   3.800111622313274*^9, 3.800111645453257*^9}, {3.800111824482594*^9, 
   3.800111825500164*^9}, {3.8001118796307297`*^9, 3.800111882116166*^9}, {
   3.8001119795088167`*^9, 3.800112070368024*^9}, {3.800112178350418*^9, 
   3.800112274038444*^9}, {3.800112304873478*^9, 3.800112436803549*^9}, {
   3.800112591144671*^9, 3.800112601902886*^9}, {3.800113553268437*^9, 
   3.800113744306192*^9}, {3.800113789818708*^9, 3.8001137904028788`*^9}, {
   3.80011384743303*^9, 3.800113899432433*^9}, 3.800113932800486*^9, {
   3.800113988149922*^9, 3.800114119497328*^9}, {3.8001141725819407`*^9, 
   3.800114318075431*^9}, {3.800114356809039*^9, 3.800114534385125*^9}, {
   3.800114678438428*^9, 3.8001147057072353`*^9}, {3.800168940790052*^9, 
   3.8001689538200817`*^9}, {3.8001692450754757`*^9, 3.800169313305381*^9}, {
   3.8001695062135687`*^9, 3.800169538679743*^9}, {3.800169680005986*^9, 
   3.8001696858569098`*^9}, {3.8001697902413397`*^9, 3.800169797090272*^9}, {
   3.800169856444117*^9, 3.800169857901354*^9}, {3.800169900486394*^9, 
   3.800169900928258*^9}, {3.800170213655205*^9, 3.800170243835273*^9}, {
   3.800172492711267*^9, 3.8001725240894337`*^9}, 3.800172942959557*^9, {
   3.800173321230383*^9, 3.800173322254651*^9}, {3.800173402761592*^9, 
   3.800173403541243*^9}, {3.800173749816564*^9, 3.800173771335474*^9}, {
   3.800174549669623*^9, 3.800174550246249*^9}, {3.800174839720869*^9, 
   3.800174843033098*^9}, {3.800176794620627*^9, 3.80017681324504*^9}, {
   3.800176937367257*^9, 3.800177036507769*^9}, {3.800177168175186*^9, 
   3.8001772265132637`*^9}, {3.8001773175659847`*^9, 3.800177394364915*^9}, {
   3.800177491838176*^9, 3.8001774985521297`*^9}, {3.80017755925322*^9, 
   3.800177562615806*^9}, {3.800177756786631*^9, 3.800177757241394*^9}, {
   3.8001782928507357`*^9, 3.80017829360398*^9}, {3.820711054920054*^9, 
   3.820711107268072*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"31334c84-d347-4ffb-9f4b-9ec651e787fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"resultsBiased", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.800112753442*^9, 3.800112758683695*^9}, {
  3.8001772997410107`*^9, 3.800177306518354*^9}, {3.80017745751761*^9, 
  3.800177460738491*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"bb108516-9f5e-490f-bc49-70a30236ea86"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Steady state\"\>", "\<\"Stability\"\>", "\<\"Uniqueness\"\>"},
     {
      RowBox[{"{", 
       RowBox[{"2.5`", ",", "7.5`", ",", "7.5`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "2.388116137669302`", ",", "7.430941931165349`", ",", 
        "7.430941931165349`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "2.275119203181168`", ",", "7.362440398409416`", ",", 
        "7.362440398409416`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "2.1609563008646413`", ",", "7.29452184956768`", ",", 
        "7.29452184956768`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "2.0455730828345353`", ",", "7.227213458582733`", ",", 
        "7.227213458582733`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.928914136632779`", ",", "7.160542931683611`", ",", 
        "7.160542931683611`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.8109235232864076`", ",", "7.0945382383567965`", ",", 
        "7.0945382383567965`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.6915455066763148`", ",", "7.029227246661843`", ",", 
        "7.029227246661843`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.5707255248293626`", ",", "6.964637237585318`", ",", 
        "6.964637237585318`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.4484114653064883`", ",", "6.900794267346756`", ",", 
        "6.900794267346756`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.324555320336759`", ",", "6.83772233983162`", ",", 
        "6.83772233983162`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.1991153126202434`", ",", "6.775442343689878`", ",", 
        "6.775442343689878`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "1.0720585993167366`", ",", "6.713970700341632`", ",", 
        "6.713970700341632`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.9433646785899338`", ",", "6.653317660705033`", ",", 
        "6.653317660705033`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.813029638195258`", ",", "6.593485180902371`", ",", 
        "6.593485180902371`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.6810713955924849`", ",", "6.534464302203758`", ",", 
        "6.534464302203758`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.5475360785401455`", ",", "6.476231960729927`", ",", 
        "6.476231960729927`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.41250567601053467`", ",", "6.418747161994733`", ",", 
        "6.418747161994733`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.27610704016862153`", ",", "6.361946479915689`", ",", 
        "6.361946479915689`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "0.13852222617043797`", ",", "6.3057388869147815`", ",", 
        "6.3057388869147815`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "6.25`", ",", "6.25`"}], "}"}], "}"}], "0", "True"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.800178971444579*^9},
 CellLabel->
  "Out[14]//MatrixForm=",ExpressionUUID->"e081cf12-5921-4b19-b33b-\
a48252643154"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"phivalue", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", "10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probabilities", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"prob", "=", "0"}], ",", 
    RowBox[{"prob", "<", "1.05"}], ",", 
    RowBox[{"prob", "=", 
     RowBox[{"prob", "+", 
      RowBox[{"(", 
       RowBox[{"5", "/", "100"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"probabilities", ",", 
      RowBox[{"probabilityMatrix", "[", 
       RowBox[{"prob", ",", "3", ",", "4", ",", "phivalue"}], "]"}]}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"resultsUnbiased", " ", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Steady state\>\"", ",", "\"\<Stability\>\"", ",", 
       "\"\<Uniqueness\>\""}], "}"}], "}"}]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi2", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi3", "=", 
   RowBox[{"phivalue", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"case", "=", "1"}], ",", 
   RowBox[{"case", "<", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "probabilities", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
   RowBox[{"case", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p111", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p112", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p12", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p212", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"probabilities", "[", 
        RowBox[{"[", "case", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p22", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p32", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p12"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p211", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi2"}], ")"}], " ", "*", " ", "p111"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p311", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi1", "/", "phi3"}], ")"}], "*", " ", "p112"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p312", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"phi2", "/", "phi3"}], ")"}], "*", " ", "p212"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dn1s", "=", 
     RowBox[{
      RowBox[{"phi1", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p111", "-", "p112", "-", "p12"}], ")"}]}], "+", 
      RowBox[{"n1", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", "p111"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p112"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi1", " ", "*", " ", "p12"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn2s", "=", 
     RowBox[{
      RowBox[{"phi2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p211", "-", "p212", "-", "p22"}], ")"}]}], "+", 
      RowBox[{"n2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p211"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p212"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi2", " ", "*", " ", "p22"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dn3s", "=", 
     RowBox[{
      RowBox[{"phi3", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p311", "-", "p312", "-", "p32"}], ")"}]}], "+", 
      RowBox[{"n3", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "mu"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p311"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p312"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n2", "+", "n3"}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"phi3", " ", "*", " ", "p32"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n1", "+", "n2", "+", "n3"}], ")"}]}], ")"}]}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dn1s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn2s", "\[Equal]", "0"}], ",", 
         RowBox[{"dn3s", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"n1", ">", "0"}], "&&", 
           RowBox[{"n2", ">", "0"}], "&&", 
           RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", "solution"}],
          ",", " ", "True"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"currentResult", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"solution", " ", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n1", ">", "0"}], "&&", 
              RowBox[{"n2", ">", "0"}], "&&", 
              RowBox[{"n3", ">", "0"}]}], "/.", "\[VeryThinSpace]", 
             "solution"}], ",", " ", "True"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dn1s", ",", "dn2s", ",", "dn3s"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eigenv", "=", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"M", "/.", 
          RowBox[{"currentResult", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"resultsUnbiased", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", 
             RowBox[{"currentResult", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}], ",", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"eigenv", ",", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}]}], "]"}], ",", "True"}], "}"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"resultsUnbiased", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "/.", "solution"}], 
           "//", "N"}], ",", "0", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "\[VeryThinSpace]", "solution", "]"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "p111", ",", "p112", ",", "p12", ",", "p212", ",", "dn1s", ",", "dn2s", 
      ",", "dn3s", ",", "solution"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8001713726131487`*^9, 3.80017139124542*^9}, {
   3.80017255908288*^9, 3.800172559307678*^9}, 3.800172964629113*^9, {
   3.8001733307640743`*^9, 3.800173331351112*^9}, {3.800173408383896*^9, 
   3.8001734093011217`*^9}, {3.800173451292972*^9, 3.800173467005705*^9}, 
   3.80017379548*^9, {3.8001745341427317`*^9, 3.800174535809085*^9}, {
   3.80017482035261*^9, 3.800174823286515*^9}, {3.800176840936591*^9, 
   3.800176841973927*^9}, {3.800177611365897*^9, 3.8001776366398497`*^9}, {
   3.800177691377817*^9, 3.800177703353242*^9}, {3.800177762934052*^9, 
   3.800177763794149*^9}, {3.800178022763298*^9, 3.800178023286894*^9}, {
   3.8001782966415367`*^9, 3.800178297426361*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"df0f08b6-8dab-4c04-8878-f8646b844150"],

Cell[BoxData[
 TemplateBox[{
  "Solve","svars",
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"",2,
   23,1,31950116397799062038,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8001790125136747`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"1ce4f467-fd36-493f-b063-2c9d6496ea4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"resultsUnbiased", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.800171403982614*^9, 3.800171408475544*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"1cef201c-22a5-4bec-8822-37c073045672"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Steady state\"\>", "\<\"Stability\"\>", "\<\"Uniqueness\"\>"},
     {
      RowBox[{"{", 
       RowBox[{
       "6.666666666666667`", ",", "6.666666666666667`", ",", 
        "6.666666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"6.5`", ",", "6.5`", ",", "6.5`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "6.333333333333333`", ",", "6.333333333333333`", ",", 
        "6.333333333333333`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "6.166666666666667`", ",", "6.166666666666667`", ",", 
        "6.166666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"6.`", ",", "6.`", ",", "6.`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "5.833333333333333`", ",", "5.833333333333333`", ",", 
        "5.833333333333333`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "5.666666666666667`", ",", "5.666666666666667`", ",", 
        "5.666666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"5.5`", ",", "5.5`", ",", "5.5`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "5.333333333333333`", ",", "5.333333333333333`", ",", 
        "5.333333333333333`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "5.166666666666667`", ",", "5.166666666666667`", ",", 
        "5.166666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"5.`", ",", "5.`", ",", "5.`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "4.833333333333333`", ",", "4.833333333333333`", ",", 
        "4.833333333333333`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "4.666666666666667`", ",", "4.666666666666667`", ",", 
        "4.666666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"4.5`", ",", "4.5`", ",", "4.5`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "4.333333333333333`", ",", "4.333333333333333`", ",", 
        "4.333333333333333`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "4.166666666666667`", ",", "4.166666666666667`", ",", 
        "4.166666666666667`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"4.`", ",", "4.`", ",", "4.`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "3.8333333333333335`", ",", "3.8333333333333335`", ",", 
        "3.8333333333333335`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{
       "3.6666666666666665`", ",", "3.6666666666666665`", ",", 
        "3.6666666666666665`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"3.5`", ",", "3.5`", ",", "3.5`"}], "}"}], "True", "True"},
     {
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2", ",", 
         RowBox[{"10.`", "\[VeryThinSpace]", "-", 
          RowBox[{"1.`", " ", "n1"}], "-", 
          RowBox[{"1.`", " ", "n2"}]}]}], "}"}], "}"}], "0", "True"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.800179015404111*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"9e6394f9-bd20-401a-ba8a-\
3e025402f703"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<biased.csv\>\"", ",", "resultsBiased", ",", "\"\<CSV\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.800173008916121*^9, 3.8001730268580637`*^9}, 
   3.800173089639155*^9, 3.800174176448132*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"42882b9b-661e-42ff-bbdb-0daa00ea7827"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<unbiased.csv\>\"", ",", "resultsUnbiased", ",", "\"\<CSV\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8001731553841352`*^9, 3.80017316256507*^9}, 
   3.800174178689269*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"010232c3-0cc7-4734-913b-7fec73b95508"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{492, Automatic}, {Automatic, 50}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 234, 4, 98, "Title",ExpressionUUID->"5c87234e-4abf-43c4-9769-9b60f163e7ba"],
Cell[817, 28, 322, 7, 46, "Input",ExpressionUUID->"0780766b-f4cd-4a1f-8e6f-16e171f6afee",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1164, 39, 195, 3, 67, "Section",ExpressionUUID->"c338ee92-6ddc-4ee4-997d-54e45996d114"],
Cell[CellGroupData[{
Cell[1384, 46, 167, 3, 54, "Subsection",ExpressionUUID->"6b9237fc-3418-4167-9f05-31bd6aeaeda8"],
Cell[1554, 51, 2500, 60, 199, "Input",ExpressionUUID->"710d9037-b234-437f-9f56-e0aad4fe3edf"],
Cell[CellGroupData[{
Cell[4079, 115, 186, 2, 30, "Input",ExpressionUUID->"c5165834-27b6-4879-9474-ac91f946354a"],
Cell[4268, 119, 737, 14, 34, "Output",ExpressionUUID->"22e7809e-a95a-4171-87e1-962f97a8d3f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5042, 138, 1635, 45, 52, "Input",ExpressionUUID->"409a3b1b-e139-4c05-aa64-be40938dc5fa"],
Cell[6680, 185, 827, 16, 50, "Output",ExpressionUUID->"3b75fb54-97f5-4396-a84e-1d9933b82636"],
Cell[7510, 203, 829, 16, 50, "Output",ExpressionUUID->"0389e8df-c7ba-4f21-a66e-67b78ec09583"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8376, 224, 619, 14, 30, "Input",ExpressionUUID->"d1d2e89a-b976-4823-ab02-297f77bf84b0"],
Cell[8998, 240, 741, 14, 34, "Output",ExpressionUUID->"b2ba27a0-495b-48d4-a102-b47edf8ed93a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9788, 260, 221, 4, 54, "Subsection",ExpressionUUID->"f5896fa2-82e0-4bd7-aea7-1f39e87314d7"],
Cell[CellGroupData[{
Cell[10034, 268, 3737, 101, 52, "Input",ExpressionUUID->"f0b93147-e145-4472-9521-e992f39f6171"],
Cell[13774, 371, 424, 10, 34, "Output",ExpressionUUID->"950a5072-1252-43b6-b85e-0e7aff53fad5"],
Cell[14201, 383, 422, 10, 34, "Output",ExpressionUUID->"424239ff-a252-4743-87c5-a6fda0b61949"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14660, 398, 549, 13, 30, "Input",ExpressionUUID->"22f9971c-9320-4858-9dce-9a67a4b8f5b1"],
Cell[15212, 413, 387, 8, 34, "Output",ExpressionUUID->"b8a42692-e8c3-44ee-81ae-93edf09ad58d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15648, 427, 232, 4, 54, "Subsection",ExpressionUUID->"41cd4b31-c643-4806-abd8-ff29ff319909"],
Cell[15883, 433, 2088, 59, 30, "Input",ExpressionUUID->"93cc1c14-033b-4112-8bfe-983b87cb337e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18020, 498, 196, 3, 67, "Section",ExpressionUUID->"ab37a02a-8d5d-4815-b5bd-2bf0364ba1de"],
Cell[CellGroupData[{
Cell[18241, 505, 9524, 242, 388, "Input",ExpressionUUID->"eb4d7113-195d-4812-9185-51d78b6ecd92"],
Cell[27768, 749, 2636, 71, 94, "Output",ExpressionUUID->"36a8d743-7e9b-4ced-b689-30a41eeeba58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30441, 825, 9423, 263, 640, "Input",ExpressionUUID->"e96436ad-0794-45bf-be94-c35fcc145d99"],
Cell[39867, 1090, 537, 11, 24, "Message",ExpressionUUID->"80904d11-2f1a-4f0e-8edc-1ce35f35f12b"],
Cell[CellGroupData[{
Cell[40429, 1105, 5492, 167, 102, "Print",ExpressionUUID->"73ef757b-52c6-4907-bede-714f43ab7a19"],
Cell[45924, 1274, 894, 26, 56, "Print",ExpressionUUID->"6087c704-db6f-456c-b5d4-8296575d715e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46867, 1306, 150, 2, 30, "Input",ExpressionUUID->"faf0b435-a3f8-42ce-ae06-a66b6b1bc240"],
Cell[47020, 1310, 1123, 27, 96, "Output",ExpressionUUID->"944f06cd-e6d7-4af3-a23e-9953677ccb99"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48192, 1343, 157, 3, 53, "Subtitle",ExpressionUUID->"5a1c2cd8-6bac-49c6-bc98-c7030d460dfd"],
Cell[48352, 1348, 13313, 325, 682, "Input",ExpressionUUID->"31334c84-d347-4ffb-9f4b-9ec651e787fb"],
Cell[CellGroupData[{
Cell[61690, 1677, 312, 5, 30, "Input",ExpressionUUID->"bb108516-9f5e-490f-bc49-70a30236ea86"],
Cell[62005, 1684, 3967, 120, 422, "Output",ExpressionUUID->"e081cf12-5921-4b19-b33b-a48252643154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66009, 1809, 10546, 289, 682, "Input",ExpressionUUID->"df0f08b6-8dab-4c04-8878-f8646b844150"],
Cell[76558, 2100, 354, 9, 24, "Message",ExpressionUUID->"1ce4f467-fd36-493f-b063-2c9d6496ea4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76949, 2114, 218, 3, 30, "Input",ExpressionUUID->"1cef201c-22a5-4bec-8822-37c073045672"],
Cell[77170, 2119, 3716, 111, 422, "Output",ExpressionUUID->"9e6394f9-bd20-401a-ba8a-3e025402f703"]
}, Open  ]],
Cell[80901, 2233, 349, 7, 30, "Input",ExpressionUUID->"42882b9b-661e-42ff-bbdb-0daa00ea7827"],
Cell[81253, 2242, 334, 8, 30, "Input",ExpressionUUID->"010232c3-0cc7-4734-913b-7fec73b95508"]
}, Open  ]]
}, Open  ]]
}
]
*)

